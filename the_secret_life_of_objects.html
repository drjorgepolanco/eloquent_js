<html>
<head>
  <title>The Secret Life of Objects</title>
</head>
<body>
<script type="text/javascript">

  // THE SECRET LIFE OF OBJECTS
  // ==========================
  
  // --------------------------------------------------------------------------
  // Methods
  // -------

  var rabbit = {};
  rabbit.speak = function(line) {
    console.log("The rabbit says '" + line + "'");
  };
  rabbit.speak("I'm alive!"); 
  // → The rabbit says 'I'm alive!'


  // 'this' points to the object it was called on.
  function speak(line) {
    console.log("The " + this.type + " rabbit says '" + line + "'");
  };
  var whiteRabbit = {type: "white", speak: speak};
  var fatRabbit = {type: "fat", speak: speak};

  whiteRabbit.speak("Oh my ears and whiskers, " + "how late it's getting!");
  // → The white rabbit says 'Oh my ears and whiskers, how late it's getting!'

  fatRabbit.speak("I could sure use a carrot right now.");
  // → The fat rabbit says 'I could sure use a carrot right now.'

  speak.apply(fatRabbit, ["burp!"]);
  // → The fat rabbit says 'burp!'

  speak.call({type: "old"}, "Oh my...");
  // → The old rabbit says 'Oh my...'
  
  // --------------------------------------------------------------------------
  // Prototypes
  // ----------

  var protoRabbit = {
    speak: function(line) {
      console.log("The " + this.type + " rabbit says '" + line + "'");
    }
  };
  var killerRabbit = Object.create(protoRabbit);
  killerRabbit.type = "killer";
  killerRabbit.speak("SKREEEEE!!!");
  // → The killer rabbit says 'SKREEEEE!!!'

  // --------------------------------------------------------------------------
  // Constructors
  // ------------

  function Rabbit(type) {
    this.type = type;
  };

  var killerRabbit = new Rabbit("killer");
  var blackRabbit = new Rabbit("black");
  console.log(blackRabbit.type);
  // → black

  Rabbit.prototype.speak = function(line) {
    console.log("The " + this.type + " rabbit says '" + line + "'");
  };
  blackRabbit.speak("Doom...");
  // → The black rabbit says 'Doom...'

  // --------------------------------------------------------------------------
  // Overriding Derived Properties
  // -----------------------------

  Rabbit.prototype.teeth = "small";
  console.log(killerRabbit.teeth);
  // → small
  killerRabbit.teeth = "long, sharp, and bloody";
  console.log(killerRabbit.teeth);
  // → long, sharp, and bloody
  console.log(blackRabbit.teeth);
  // → small
  console.log(Rabbit.prototype.teeth);
  // → small

  // Calling toString() on an array gives a result similar to calling .join(",")
  // on it - it puts commas between the values in the array. But directly calling
  // Object.prototype.toString with an array produces a different string.

  console.log(Array.prototype.toString == Object.prototype.toString);
  // → false
  console.log([1, 2].toString());
  // → 1, 2

  console.log(Object.prototype.toString.call([1, 2]));
  // → [object Array]

</script>
</body>
</html>